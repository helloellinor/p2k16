{{/* Form Component */}}
{{define "htmx-form"}}
<form class="p2k16-form {{if .class}}{{.class}}{{end}}" 
      hx-post="{{.action}}" 
      hx-target="{{.target}}" 
      {{if .swap}}hx-swap="{{.swap}}"{{end}}
      {{if .indicator}}hx-indicator="{{.indicator}}"{{end}}
      {{if .ext}}hx-ext="{{.ext}}"{{end}}>
    
    {{range .fields}}
    <div class="p2k16-field">
        <label for="{{.name}}" class="p2k16-field__label">{{.label}}</label>
        {{if eq .type "textarea"}}
        <textarea class="p2k16-field__input" 
                  id="{{.name}}" 
                  name="{{.name}}" 
                  placeholder="{{.placeholder}}"
                  {{if .required}}required{{end}}>{{.value}}</textarea>
        {{else if eq .type "select"}}
        <select class="p2k16-field__input" 
                id="{{.name}}" 
                name="{{.name}}" 
                {{if .required}}required{{end}}>
            {{range .options}}
            <option value="{{.value}}" {{if .selected}}selected{{end}}>{{.label}}</option>
            {{end}}
        </select>
        {{else}}
        <input type="{{.type}}" 
               class="p2k16-field__input" 
               id="{{.name}}" 
               name="{{.name}}" 
               placeholder="{{.placeholder}}"
               value="{{.value}}"
               {{if .required}}required{{end}}>
        {{end}}
        {{if .help}}
        <div class="p2k16-field__help">{{.help}}</div>
        {{end}}
    </div>
    {{end}}
    
    <div class="p2k16-form__actions">
        <button type="submit" class="p2k16-button p2k16-button--primary">
            <span class="htmx-indicator">
                <span class="p2k16-spinner"></span>
            </span>
            {{.submitText}}
        </button>
        {{if .cancelUrl}}
        <a href="{{.cancelUrl}}" class="p2k16-button p2k16-button--secondary">Cancel</a>
        {{end}}
    </div>
</form>
{{end}}

{{/* Alert Component */}}
{{define "alert"}}
<div class="p2k16-alert p2k16-alert--{{.type}} {{if .dismissible}}p2k16-alert--dismissible{{end}}">
    {{if .dismissible}}
    <button class="p2k16-alert__close" onclick="this.parentElement.remove()">Ã—</button>
    {{end}}
    {{if .title}}
    <strong>{{.title}}</strong>
    {{end}}
    {{.message}}
</div>
{{end}}

{{/* Card Component */}}
{{define "card"}}
<div class="p2k16-card {{if .class}}{{.class}}{{end}}">
    {{if .title}}
    <div class="p2k16-card__header">
        <h5 class="p2k16-card__title">{{.title}}</h5>
        {{if .subtitle}}
        <p class="p2k16-card__subtitle">{{.subtitle}}</p>
        {{end}}
    </div>
    {{end}}
    <div class="p2k16-card__body">
        {{.content}}
    </div>
    {{if .footer}}
    <div class="p2k16-card__footer">
        {{.footer}}
    </div>
    {{end}}
</div>
{{end}}

{{/* Button with HTMX */}}
{{define "htmx-button"}}
<button class="p2k16-button p2k16-button--{{.variant}} {{if .class}}{{.class}}{{end}}" 
        {{if .get}}hx-get="{{.get}}"{{end}}
        {{if .post}}hx-post="{{.post}}"{{end}}
        {{if .put}}hx-put="{{.put}}"{{end}}
        {{if .delete}}hx-delete="{{.delete}}"{{end}}
        {{if .target}}hx-target="{{.target}}"{{end}}
        {{if .swap}}hx-swap="{{.swap}}"{{end}}
        {{if .vals}}hx-vals="{{.vals}}"{{end}}
        {{if .confirm}}hx-confirm="{{.confirm}}"{{end}}
        {{if .indicator}}hx-indicator="{{.indicator}}"{{end}}
        {{if .disabled}}disabled{{end}}>
    <span class="htmx-indicator">
        <span class="p2k16-spinner"></span>
    </span>
    {{.text}}
</button>
{{end}}

{{/* Loading Spinner */}}
{{define "loading-spinner"}}
<div class="p2k16-loading {{if .class}}{{.class}}{{end}}">
    <span class="p2k16-spinner"></span>
    {{if .text}}
    <span class="p2k16-loading__text">{{.text}}</span>
    {{end}}
</div>
{{end}}

{{/* Badge List */}}
{{define "badge-list"}}
<div class="p2k16-badge-list">
    {{range .badges}}
    <span class="p2k16-badge p2k16-badge--{{.color}}">{{.title}}</span>
    {{end}}
    {{if not .badges}}
    <p class="p2k16-text--muted">{{.emptyMessage}}</p>
    {{end}}
</div>
{{end}}

{{/* Data Table */}}
{{define "data-table"}}
<div class="p2k16-table-wrapper">
    <table class="p2k16-table">
        {{if .headers}}
        <thead>
            <tr>
                {{range .headers}}
                <th>{{.}}</th>
                {{end}}
            </tr>
        </thead>
        {{end}}
        <tbody>
            {{range .rows}}
            <tr>
                {{range .}}
                <td>{{.}}</td>
                {{end}}
            </tr>
            {{end}}
        </tbody>
    </table>
    {{if not .rows}}
    <div class="p2k16-table__empty">
        <p class="p2k16-text--muted">{{.emptyMessage}}</p>
    </div>
    {{end}}
</div>
{{end}}

{{/* Modal Component */}}
{{define "modal"}}
<div class="p2k16-modal" id="{{.id}}" style="display: none;">
    <div class="p2k16-modal__backdrop" onclick="closeModal('{{.id}}')"></div>
    <div class="p2k16-modal__content">
        <div class="p2k16-modal__header">
            <h5 class="p2k16-modal__title">{{.title}}</h5>
            <button class="p2k16-modal__close" onclick="closeModal('{{.id}}')">&times;</button>
        </div>
        <div class="p2k16-modal__body">
            {{.content}}
        </div>
        {{if .footer}}
        <div class="p2k16-modal__footer">
            {{.footer}}
        </div>
        {{end}}
    </div>
</div>

<script>
function openModal(id) {
    document.getElementById(id).style.display = 'flex';
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}
</script>
{{end}}